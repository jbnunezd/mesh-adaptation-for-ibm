 
!======================================================================================================================!
!
! IBM-MESH-ADAPTATION-TOOL
!
! Copyright (c) 2020 by Jonatan Nunez
!
! This program is free software: you can redistribute it and/or modify it under the terms of the GNU 
! General Public License as published by the Free Software Foundation, either version 3 of the License, 
! or (at your option) any later version.
! 
! This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even 
! the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
! See the GNU General Public License for more details.
! 
! You should have received a copy of the GNU General Public License along with this program.
! If not, see <https://www.gnu.org/licenses/>.
!
!======================================================================================================================!
!
!======================================================================================================================!
#include "main.h"
!======================================================================================================================!
!
!======================================================================================================================!
MODULE MOD_VectorAlgebra
!----------------------------------------------------------------------------------------------------------------------!
USE MOD_GLOBAL_vars
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
PRIVATE
!----------------------------------------------------------------------------------------------------------------------!
INTERFACE CROSSPRODUCT
  MODULE PROCEDURE CROSSPRODUCT
END INTERFACE

INTERFACE DOTPRODUCT
  MODULE PROCEDURE DOTPRODUCT
END INTERFACE

!----------------------------------------------------------------------------------------------------------------------!
PUBLIC :: CROSSPRODUCT
PUBLIC :: DOTPRODUCT
!----------------------------------------------------------------------------------------------------------------------!
!
!
!
!======================================================================================================================!
CONTAINS
!======================================================================================================================!
!
!
!
!======================================================================================================================!
FUNCTION CROSSPRODUCT(v1,v2) RESULT(v3)
!----------------------------------------------------------------------------------------------------------------------!
! Cross product
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
! FORMAL ARGUMENTS
!----------------------------------------------------------------------------------------------------------------------!
REAL,INTENT(IN) :: v1(1:3)
REAL,INTENT(IN) :: v2(1:3)
REAL            :: v3(1:3)
!----------------------------------------------------------------------------------------------------------------------!
! LOCAL VARIABLES
!----------------------------------------------------------------------------------------------------------------------!

v3(1) = v1(2)*v2(3)-v1(3)*v2(2)
v3(2) = v1(3)*v2(1)-v1(1)*v2(3)
v3(3) = v1(1)*v2(2)-v1(2)*v2(1)

!----------------------------------------------------------------------------------------------------------------------!
END FUNCTION CROSSPRODUCT
!======================================================================================================================!
!
!
!
!======================================================================================================================!
FUNCTION DOTPRODUCT(v1,v2) RESULT(v)
!----------------------------------------------------------------------------------------------------------------------!
! Dot product
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
! FORMAL ARGUMENTS
!----------------------------------------------------------------------------------------------------------------------!
REAL,INTENT(IN) :: v1(:)
REAL,INTENT(IN) :: v2(:)
REAL            :: v
!----------------------------------------------------------------------------------------------------------------------!
! LOCAL VARIABLES
!----------------------------------------------------------------------------------------------------------------------!
INTEGER :: ii
!----------------------------------------------------------------------------------------------------------------------!
CHARACTER(LEN=256) :: ErrorMessage
!----------------------------------------------------------------------------------------------------------------------!

IF (SIZE(v1) .NE. SIZE(v2)) THEN
  ErrorMessage = "DOTPRODUCT: Vectors have different size"
  CALL PrintError(__STAMP__,ErrorMessage)
END IF

v = 0.0
DO ii=1,SIZE(v1)
  v = v + v1(ii)*v2(ii)
END DO

!----------------------------------------------------------------------------------------------------------------------!
END FUNCTION DOTPRODUCT
!======================================================================================================================!
!
!
!
!----------------------------------------------------------------------------------------------------------------------!
END MODULE MOD_VectorAlgebra
!======================================================================================================================!
