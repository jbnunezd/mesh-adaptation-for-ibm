!======================================================================================================================!
!
! IBM-MESH-ADAPTATION-TOOL
!
! Copyright (c) 2020 by Jonatan Nunez
!
! This program is free software: you can redistribute it and/or modify it under the terms of the GNU 
! General Public License as published by the Free Software Foundation, either version 3 of the License, 
! or (at your option) any later version.
! 
! This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even 
! the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
! See the GNU General Public License for more details.
! 
! You should have received a copy of the GNU General Public License along with this program.
! If not, see <https://www.gnu.org/licenses/>.
!
!======================================================================================================================!
!
!======================================================================================================================!
#include "main.h"
!======================================================================================================================!
!
!======================================================================================================================!
MODULE MOD_MeshBuiltInStretchingFunctions3D
!----------------------------------------------------------------------------------------------------------------------!
USE MOD_GLOBAL_vars
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
PUBLIC
!----------------------------------------------------------------------------------------------------------------------!
INTERFACE MeshStretching3D_Uniform
  MODULE PROCEDURE MeshStretching3D_Uniform
END INTERFACE
!----------------------------------------------------------------------------------------------------------------------!
PUBLIC :: MeshStretching3D_Uniform
!----------------------------------------------------------------------------------------------------------------------!
!
!
!
!======================================================================================================================!
CONTAINS
!======================================================================================================================!
!
!
!
!======================================================================================================================!
SUBROUTINE MeshStretching3D_Uniform(nElems,dx,dy,dz)
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
! FORMAL ARGUMENTS
!----------------------------------------------------------------------------------------------------------------------!
INTEGER,INTENT(IN) :: nElems(1:3)
REAL,INTENT(OUT)   :: dx(1:nElems(1))
REAL,INTENT(OUT)   :: dy(1:nElems(2))
REAL,INTENT(OUT)   :: dz(1:nElems(3))
!----------------------------------------------------------------------------------------------------------------------!
! LOCAL VARIABLES
!----------------------------------------------------------------------------------------------------------------------!

dx(1:nElems(1)) = 1.0
dy(1:nElems(2)) = 1.0
dz(1:nElems(3)) = 1.0

dx = dx*(2.0/SUM(dx(1:nElems(1))))
dy = dy*(2.0/SUM(dy(1:nElems(2))))
dz = dz*(2.0/SUM(dz(1:nElems(3))))

!----------------------------------------------------------------------------------------------------------------------!
END SUBROUTINE MeshStretching3D_Uniform
!======================================================================================================================!
!
!
!
!----------------------------------------------------------------------------------------------------------------------!
END MODULE MOD_MeshBuiltInStretchingFunctions3D
!======================================================================================================================!
