!======================================================================================================================!
!
! IBM-MESH-ADAPTATION-TOOL
!
! Copyright (c) 2020 by Jonatan Nunez
!
! This program is free software: you can redistribute it and/or modify it under the terms of the GNU 
! General Public License as published by the Free Software Foundation, either version 3 of the License, 
! or (at your option) any later version.
! 
! This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even 
! the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
! See the GNU General Public License for more details.
! 
! You should have received a copy of the GNU General Public License along with this program.
! If not, see <https://www.gnu.org/licenses/>.
!
!======================================================================================================================!
!
!======================================================================================================================!
#include "main.h"
!======================================================================================================================!
!
!======================================================================================================================!
MODULE MOD_MeshBuiltInMappings3D
!----------------------------------------------------------------------------------------------------------------------!
USE MOD_GLOBAL_vars
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
PUBLIC
!----------------------------------------------------------------------------------------------------------------------!
INTERFACE Mapping3D_StraightHexa
  MODULE PROCEDURE Mapping3D_StraightHexa
END INTERFACE
!----------------------------------------------------------------------------------------------------------------------!
PUBLIC :: Mapping3D_StraightHexa
!----------------------------------------------------------------------------------------------------------------------!
!
!
!
!======================================================================================================================!
CONTAINS
!======================================================================================================================!
!
!
!
!======================================================================================================================!
SUBROUTINE Mapping3D_StraightHexa(WhichFace,s,xc,x)
!----------------------------------------------------------------------------------------------------------------------!
IMPLICIT NONE
!----------------------------------------------------------------------------------------------------------------------!
! FORMAL ARGUMENTS
!----------------------------------------------------------------------------------------------------------------------!
INTEGER,INTENT(IN) :: WhichFace
REAL,INTENT(IN)    :: s(1:2)
REAL,INTENT(IN)    :: xc(1:8,1:3)
REAL,INTENT(OUT)   :: x(1:3)
!----------------------------------------------------------------------------------------------------------------------!
! LOCAL VARIABLES
!----------------------------------------------------------------------------------------------------------------------!

SELECT CASE(WhichFace)
  CASE(1)
    x(1:3) = 0.25*(xc(1,1:3)*(1.0-s(1))*(1.0-s(2)) + &
                   xc(2,1:3)*(1.0+s(1))*(1.0-s(2)) + &
                   xc(3,1:3)*(1.0+s(1))*(1.0+s(2)) + &
                   xc(4,1:3)*(1.0-s(1))*(1.0+s(2)))
  CASE(2)
    x(1:3) = 0.25*(xc(1,1:3)*(1.0-s(1))*(1.0-s(2)) + &
                   xc(2,1:3)*(1.0+s(1))*(1.0-s(2)) + &
                   xc(5,1:3)*(1.0-s(1))*(1.0+s(2)) + &
                   xc(6,1:3)*(1.0+s(1))*(1.0+s(2)))
  CASE(3)
    x(1:3) = 0.25*(xc(2,1:3)*(1.0-s(1))*(1.0-s(2)) + &
                   xc(3,1:3)*(1.0+s(1))*(1.0-s(2)) + &
                   xc(6,1:3)*(1.0-s(1))*(1.0+s(2)) + &
                   xc(7,1:3)*(1.0+s(1))*(1.0+s(2)))
  CASE(4)
    x(1:3) = 0.25*(xc(3,1:3)*(1.0+s(1))*(1.0-s(2)) + &
                   xc(4,1:3)*(1.0-s(1))*(1.0-s(2)) + &
                   xc(7,1:3)*(1.0+s(1))*(1.0+s(2)) + &
                   xc(8,1:3)*(1.0-s(1))*(1.0+s(2)))
  CASE(5)
    x(1:3) = 0.25*(xc(1,1:3)*(1.0-s(1))*(1.0-s(2)) + &
                   xc(4,1:3)*(1.0+s(1))*(1.0-s(2)) + &
                   xc(5,1:3)*(1.0-s(1))*(1.0+s(2)) + &
                   xc(8,1:3)*(1.0+s(1))*(1.0+s(2)))
  CASE(6)
    x(1:3) = 0.25*(xc(5,1:3)*(1.0-s(1))*(1.0-s(2)) + &
                   xc(6,1:3)*(1.0+s(1))*(1.0-s(2)) + &
                   xc(7,1:3)*(1.0+s(1))*(1.0+s(2)) + &
                   xc(8,1:3)*(1.0-s(1))*(1.0+s(2)))
END SELECT

!----------------------------------------------------------------------------------------------------------------------!
END SUBROUTINE Mapping3D_StraightHexa
!======================================================================================================================!
!
!
!
!----------------------------------------------------------------------------------------------------------------------!
END MODULE MOD_MeshBuiltInMappings3D
!======================================================================================================================!
